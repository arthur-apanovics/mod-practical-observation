define(["jquery","core/ajax","core/notification"],function(a,b,c){return{init:function(){var d="table.observer-details",e="a.edit-details",f=a(".personal-details"),g=f.find(d),h=f.find(e),i=function(b){f.find("button[type=submit]").fadeOut(500,function(){a(this).remove()}),f.unwrap(),h.show();var c=g.find("#details-values > td:not(#email)");b?c.each(function(){a(this).removeAttr("data-original_value").html(b[this.id])}):c.each(function(){a(this).html(a(this).data("original_value")).removeAttr("data-original_value")})},j=function(d){d.preventDefault();var e=a(this).find("tr#details-values"),g={observerid:e.data("observerid"),fullname:e.find("[name=fullname]").val(),phone:e.find("[name=phone]").val(),position_title:e.find("[name=position_title]").val()};f.find("button[type=submit]").attr("disabled",!0),b.call([{methodname:"mod_observation_observer_update_details",args:g,done:i,fail:function(a){i(null),c.alert("There was a problem","Sorry, something went wrong when updating your details.<br>Please contact an administrator regarding this issue"),console.error(a)}}],!0,!1)};h.on("click",function(b){console.log("clicked!"),g.addClass("editing"),g.find("#details-values > td:not(#email)").each(function(){var b=a(this).text();a(this).attr("data-original_value",b).html(a("<input required/>").attr({type:"text",name:this.id,value:b}))}),f.append(a('<div style="text-align: right; display: none;"><button type="submit">Save</button></div>').fadeIn(500)),h.hide(),$form=a('<form id="edit-details-form">').on("submit",j),f.wrap($form)});var k=a("form#requirement-acknowledge #acknowledge_checkbox"),l=a("form#requirement-acknowledge #submit-accept");k.attr("disabled",!1),k.on("change",function(a){l.attr("disabled",!this.checked)})}}});